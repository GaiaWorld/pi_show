<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1" name="viewport" />
    <script>
        var Module = {};
        var __cargo_web = {};
    </script>
</head>
<body>
    <canvas id="canvas" width = "1000px" height="1000px"></canvas>
    <script>
        var YGEdgeLeft = 0;
        var YGEdgeTop = 1;
        var YGEdgeRight = 2;
        var YGEdgeBottom = 3;
        var YGEdgeStart = 4;
        var YGEdgeEnd = 5;
        var YGEdgeHorizontal = 6;
        var YGEdgeVertical = 7;
        var YGEdgeAll = 8;

        var YGWrapNoWrap = 0;
        var YGWrapWrap = 1; 
        var YGWrapWrapReverse = 2;
    </script>
    
    <script src="../../target/asmjs-unknown-emscripten/release/gui_web2.js"></script>
    <script src="../shader/clip.js"></script>
    <script src="../shader/color.js"></script>
    <script src="../shader/image.js"></script>
    <script src="../shader/text.js"></script>
    <script src="../shader/canvas_text.js"></script>
    <script src="../shader/init.js"></script>
    <script>
        window.__p = {};
        var gui = Module._create_gui(engine, 1000, 1000);

        var body = Module._create_node(gui);
        Module._append_child(gui, body, 1); // 接口已修改， node和parent顺序颠倒
        Module._set_width_percent(gui, body, 100.0);
        Module._set_height_percent(gui, body, 100.0);
        Module._set_flex_wrap(gui, body, YGWrapWrap);

        var node2 = Module._create_node(gui);
        Module._append_child(gui, node2, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node2, 40);
        Module._set_height(gui, node2, 40);
        Module._set_background_rgba_color(gui, node2, 0.0, 1.0, 0.0, 1.0);

        var node3 = Module._create_node(gui);
        Module._append_child(gui, node3, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node3, 40);
        Module._set_height(gui, node3, 40);
        Module._set_margin(gui, node3, YGEdgeLeft, 10);
        Module._set_background_rgba_color(gui, node3, 0.0, 1.0, 0.0, 1.0);

        var node4 = Module._create_node(gui);
        Module._append_child(gui, node4, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node4, 40.0);
        Module._set_height(gui, node4, 40.0);
        Module._set_margin(gui, node4, YGEdgeLeft, 10);
        Module._set_border_radius(gui, node4, 20, 20);
        Module._set_background_rgba_color(gui, node4, 0.0, 1.0, 0.0, 1.0);


        // 测试两点线性渐变颜色
        var node5 = Module._create_node(gui);
        Module._append_child(gui, node5, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node5, 40.0);
        Module._set_height(gui, node5, 40.0);
        Module._set_margin(gui, node5, YGEdgeLeft, 10);
        window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,    0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
        Module._set_background_linear_gradient_color(gui, node5, 0);

        // 测试两点线性渐变颜色 + border_radius
        var node6 = Module._create_node(gui);
        Module._append_child(gui, node6, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node6, 40.0);
        Module._set_height(gui, node6, 40.0);
        Module._set_margin(gui, node6, YGEdgeLeft, 10);
        Module._set_border_radius(gui, node6, 20, 20);
        window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
        Module._set_background_linear_gradient_color(gui, node6, 30);

        // 测试三点线性渐变颜色
        var node7 = Module._create_node(gui);
        Module._append_child(gui, node7, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node7, 40.0);
        Module._set_height(gui, node7, 40.0);
        Module._set_margin(gui, node7, YGEdgeLeft, 10);
        // Module._set_border_radius(gui, node5, 20, 20);
        window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
        Module._set_background_linear_gradient_color(gui, node7, 30);

        // 测试三点线性渐变颜色 + border_radius
        var node8 = Module._create_node(gui);
        Module._append_child(gui, node8, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node8, 40.0);
        Module._set_height(gui, node8, 40.0);
        Module._set_margin(gui, node8, YGEdgeLeft, 10);
        Module._set_border_radius(gui, node8, 20, 20);
        window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
        Module._set_background_linear_gradient_color(gui, node8, 0);

        // 测试三点线性渐变颜色(非0度渐变角) + border_radius
        var node9 = Module._create_node(gui);
        Module._append_child(gui, node9, body); // 接口已修改， node和parent顺序颠倒
        Module._set_width(gui, node9, 40.0);
        Module._set_height(gui, node9, 40.0);
        Module._set_margin(gui, node9, YGEdgeLeft, 10);
        Module._set_border_radius(gui, node9, 20, 20);
        window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
        Module._set_background_linear_gradient_color(gui, node9, 30);

        // 
        var node10 = Module._create_node(gui);
        Module._append_child(gui, node10, body);
        Module._set_width(gui, node10, 40.0);
        Module._set_height(gui, node10, 40.0);
        Module._set_margin(gui, node10, YGEdgeLeft, 10);
        Module._set_border(gui, node10, YGEdgeAll, 5);
        Module._set_border_radius(gui, node10, 10, 10);
        Module._set_background_rgba_color(gui, node10, 0.0, 1.0, 0.0, 1.0);   

        Module._render(gui);


        //console.log("xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        var time1 = performance.now();
        for (var i = 12; i <= 112; i++) {
            var node1 = Module._create_node(gui);
        }
       console.log("create time:" , performance.now() - time1);

        var time1 = performance.now();
        for (var i = 12; i < 103; ) {
            Module._set_width(gui, i, 40);
            Module._set_height(gui, i, 40);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_background_rgba_color(gui, i , 0.0, 1.0, 0.0, 1.0);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_border_radius(gui, i , 20, 20);
            Module._set_background_rgba_color(gui, i , 0.0, 1.0, 0.0, 1.0);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,    0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 0);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_border_radius(gui, i , 20, 20);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 30);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 30);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_border_radius(gui, i , 20, 20);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 0);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_border_radius(gui, i , 20, 20);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 30);

            i += 1;
            Module._set_width(gui, i , 40.0);
            Module._set_height(gui, i , 40.0);
            Module._set_margin(gui, i , YGEdgeLeft, 10);
            Module._set_border_radius(gui, i , 20, 20);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);
            // window.__jsObj = new Float32Array([0.0, 1.0, 0.0, 1.0, 0,  1.0, 0.0, 0.0, 1.0, 0.5,  0.0, 0.0, 1.0, 1.0, 1]); //color_and_positions: [r, g, b, a, pos,   r, g, b, a, pos]。   pos: 0~1
            // Module._set_background_linear_gradient_color(gui, i , 30);

            i += 1;
            Module._set_width(gui, i, 40.0);
            Module._set_height(gui, i, 40.0);
            Module._set_margin(gui, i, YGEdgeLeft, 10);
            Module._set_border(gui, i, YGEdgeAll, 5);
            Module._set_border_radius(gui, i, 10, 10);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0);   

            i += 1;
            Module._set_width(gui, i, 40.0);
            Module._set_height(gui, i, 40.0);
            Module._set_margin(gui, i, YGEdgeLeft, 10);
            Module._set_border(gui, i, YGEdgeAll, 5);
            Module._set_border_radius(gui, i, 10, 10);
            Module._set_background_rgba_color(gui, i, 0.0, 1.0, 0.0, 1.0); 

            i += 1 ;
        }
       console.log("set time:" , performance.now() - time1);

        var time1 = performance.now();
        var nodex = Module._create_node(gui);
        Module._set_width_percent(gui, nodex, 100.0);
        Module._set_height_percent(gui, nodex, 100.0);
        Module._set_flex_wrap(gui, nodex, YGWrapWrap);
        for (var i = 12; i <= 112; i++) {
            Module._append_child(gui, i, nodex);
        }
       console.log("append time:" , performance.now() - time1);

        var time1 = performance.now();
        Module._append_child(gui, nodex, body);
       console.log("append root time:" , performance.now() - time1);

        var time1 = performance.now();
        Module._render(gui);
       console.log("render time: " +  (performance.now() - time1));
       console.log("__p: ", __p);

        Module._set_render_dirty(gui);
        var time1 = performance.now();
        Module._render(gui);
       console.log("render1 time: " +  (performance.now() - time1));
       console.log("__p: ", __p);

       render_fram();

        // setTimeout(() => {
        //     var node2 = Module._create_node(gui);
        //     Module._append_child(gui, node2, node1); // 接口已修改， node和parent顺序颠倒
        //     Module._set_width(gui, node2, 40.0);
        //     Module._set_height(gui, node2, 40.0);
        //     Module._set_margin(gui, node2, YGEdgeLeft, 10);
        //     Module._set_background_rgba_color(gui, node2, 1.0, 1.0, 0.0, 1.0);

        //     Module._render(gui);
        // }, 3000);
    </script>
</body>
</html>